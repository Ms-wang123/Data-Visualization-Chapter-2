<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据可视化仪表板</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            color: #2d3748;
            font-size: 1.5rem;
        }
        
        .controls {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .chart-container {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            height: 500px;
        }
        
        .data-table {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            height: 500px;
            overflow: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        th {
            background: #f7fafc;
            font-weight: 600;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 0.5rem;
        }
        
        .btn:hover {
            background: #5a6fd8;
        }
        
        select {
            padding: 0.5rem;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            margin-right: 1rem;
        }
        
        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container, .data-table {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <div class="header-content">
                <h1>数据可视化仪表板</h1>
                <div>
                    <button class="btn" onclick="downloadChart()">下载图表</button>
                    <button class="btn" onclick="resetData()">重置数据</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="controls">
            <select id="chartType" onchange="updateChart()">
                <option value="line">折线图</option>
                <option value="bar">柱状图</option>
                <option value="pie">饼图</option>
                <option value="radar">雷达图</option>
                <option value="scatter">散点图</option>
            </select>
            
            <select id="sortBy" onchange="updateChart()">
                <option value="default">默认排序</option>
                <option value="asc">升序</option>
                <option value="desc">降序</option>
            </select>
            
            <input type="text" id="searchInput" placeholder="搜索数据..." oninput="updateChart()">
        </div>
        
        <div class="chart-grid">
            <div class="chart-container">
                <canvas id="mainChart"></canvas>
            </div>
            
            <div class="data-table">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th>标签</th>
                            <th>数值</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let currentChart = null;
        const chartData = {
            line: {
                labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                datasets: [{
                    label: '销售额',
                    data: [65, 59, 80, 81, 56, 55],
                    borderColor: '#667eea',
                    backgroundColor: 'rgba(102, 126, 234, 0.1)',
                    tension: 0.4,
                    fill: true
                }]
            },
            bar: {
                labels: ['产品A', '产品B', '产品C', '产品D', '产品E'],
                datasets: [{
                    label: '销量',
                    data: [12, 19, 3, 5, 2],
                    backgroundColor: '#ff6b6b'
                }]
            },
            pie: {
                labels: ['购物', '餐饮', '交通', '娱乐', '其他'],
                datasets: [{
                    data: [30, 25, 15, 20, 10],
                    backgroundColor: ['#ff6b6b', '#667eea', '#feca57', '#1dd1a1', '#9c88ff']
                }]
            },
            radar: {
                labels: ['技能A', '技能B', '技能C', '技能D', '技能E'],
                datasets: [{
                    label: '能力评估',
                    data: [65, 59, 90, 81, 56],
                    backgroundColor: 'rgba(255, 107, 107, 0.2)',
                    borderColor: '#ff6b6b'
                }]
            },
            scatter: {
                datasets: [{
                    label: '速度与距离',
                    data: [
                        {x: 10, y: 0.5}, {x: 20, y: 2.0}, {x: 30, y: 4.4},
                        {x: 40, y: 7.9}, {x: 50, y: 12.3}, {x: 60, y: 17.7}
                    ],
                    backgroundColor: '#ff9ff3'
                }]
            }
        };

        function initializeChart() {
            const ctx = document.getElementById('mainChart');
            const chartType = document.getElementById('chartType').value;
            const sortBy = document.getElementById('sortBy').value;
            const searchTerm = document.getElementById('searchInput').value;
            
            let data = JSON.parse(JSON.stringify(chartData[chartType]));
            
            // 数据处理
            if (data.labels && data.datasets[0].data) {
                let processedData = processData(data, sortBy, searchTerm);
                data = processedData;
            }
            
            if (currentChart) {
                currentChart.destroy();
            }
            
            const config = {
                type: chartType === 'scatter' ? 'scatter' : chartType,
                data: data,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: getChartTitle(chartType)
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    }
                }
            };
            
            currentChart = new Chart(ctx, config);
            updateDataTable(data);
        }
        
        function processData(data, sortBy, searchTerm) {
            if (!data.labels) return data;
            
            let indices = data.labels.map((_, index) => index);
            
            // 搜索筛选
            if (searchTerm) {
                indices = indices.filter(index => 
                    data.labels[index].toLowerCase().includes(searchTerm.toLowerCase())
                );
            }
            
            // 排序
            if (sortBy !== 'default') {
                indices.sort((a, b) => {
                    const valueA = data.datasets[0].data[a];
                    const valueB = data.datasets[0].data[b];
                    return sortBy === 'asc' ? valueA - valueB : valueB - valueA;
                });
            }
            
            const processedData = JSON.parse(JSON.stringify(data));
            processedData.labels = indices.map(i => data.labels[i]);
            processedData.datasets = data.datasets.map(dataset => ({
                ...dataset,
                data: indices.map(i => dataset.data[i])
            }));
            
            return processedData;
        }
        
        function updateDataTable(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';
            
            if (data.labels && data.datasets[0].data) {
                data.labels.forEach((label, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${label}</td>
                        <td>${data.datasets[0].data[index]}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }
        }
        
        function getChartTitle(type) {
            const titles = {
                line: '月度销售趋势',
                bar: '产品销量统计',
                pie: '消费比例分布',
                radar: '能力评估雷达图',
                scatter: '速度与制动距离关系'
            };
            return titles[type] || '数据可视化图表';
        }
        
        function downloadChart() {
            if (currentChart) {
                const image = currentChart.toBase64Image();
                const link = document.createElement('a');
                link.download = 'chart.png';
                link.href = image;
                link.click();
            }
        }
        
        function resetData() {
            document.getElementById('sortBy').value = 'default';
            document.getElementById('searchInput').value = '';
            updateChart();
        }
        
        function updateChart() {
            initializeChart();
        }
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeChart();
        });
        
        // 响应式调整
        window.addEventListener('resize', function() {
            if (currentChart) {
                currentChart.resize();
            }
        });
    </script>
</body>
</html>